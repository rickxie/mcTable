var mmGrid={};function mcGrid(){var o=mmGrid=this;var u=o._={};var q={row_select:[]};o.fire=function(w){switch(w){case"row_select":q.row_select.forEach(function(z){var y=d.filter(function(A){return A.$$checked===true});z(y)})}};o.on=function(w,y){q[w]!==null&&(q[w].push(y))};var r={table:"",tr:null,td:null};var j={$$allChecked:false,checkable:false,sortable:false,tableWidth:"",fixHeaderRow:true,fixColumnNum:0,mergeColumnMainIndex:null,mergeColumns:null};var s=[];var d=[];o.InitGrid=function(B,z,A,D){s=A;l(D);f(z);var C=document.getElementById(B);r.table=u.getDefaultClass("#"+B+" table");C.removeClass("mc-table");C.addClass("mc-table");var y={wraperContainer:k("div","mc-table-wrapper mc-default"),headDivDom:k("div","mc-thead"),bodyDivDom:k("div","mc-tbody"),fixedColumn:k("div","mc-fixed-column"),fixedBody:k("div","mc-fixed-body")};var w=y.wraperContainer;var E=t(s);var G=i(s,D);var F=n("table",E+G,r.table,{width:j.tableWidth});y.bodyDivDom.innerHTML=F;g(y);C.innerHTML="";w.style.visibility="hidden";C.appendChild(w);setTimeout(function(){v(C,y);w.style.visibility="visible"},0)};var g=function(w){if(j.fixHeaderRow&&j.fixColumnNum>0){w.fixedBody.appendChild(w.headDivDom);w.fixedBody.appendChild(w.bodyDivDom);w.wraperContainer.appendChild(w.fixedColumn);w.wraperContainer.appendChild(w.fixedBody)}else{if(j.fixHeaderRow&&j.fixColumnNum==0){w.wraperContainer.appendChild(w.headDivDom);w.wraperContainer.appendChild(w.bodyDivDom)}else{if(!j.fixHeaderRow){w.wraperContainer.appendChild(w.bodyDivDom)}}}};var v=function(H,F){var C=F.headDivDom;var L=F.bodyDivDom;m(L);if(j.fixHeaderRow){var N=L.children[0];var M=N.children[0].offsetHeight;var J=H.offsetHeight-M;var I=N.cloneNode(true);I.removeChild(I.children[1]);N.removeChild(N.children[0]);C.appendChild(I);L.style.height=J;var P=L.offsetWidth>N.offsetWidth?L.offsetWidth:N.offsetWidth;N.style.width=(P-20);I.style.width=P}if(j.fixColumnNum>0){var K=H.querySelector(".mc-fixed-body .mc-thead");var O=H.querySelector(".mc-fixed-body .mc-tbody");var B=K.querySelector("table");var D=O.querySelector("table");O.style.width=H.offsetWidth+"px";var A=K.cloneNode(true);var E=O.cloneNode(true);var w=A.querySelector("table");var y=E.querySelector("table");var G=w.rows;u.forEach(G,function(T,Q){for(var S=0;S<T.cells.length;S++){var R=T.cells[S].getAttribute("ci");if(R>=j.fixColumnNum){T.cells[S].style.display="none"}else{T.cells[S].style.width=B.rows[Q].cells[S].offsetWidth;T.cells[S].style.height=B.rows[Q].cells[S].offsetHeight}}});var G=y.rows;u.forEach(G,function(T,Q){for(var S=0;S<T.cells.length;S++){var R=T.cells[S].getAttribute("ci");if(R>=j.fixColumnNum){T.cells[S].style.display="none"}else{T.cells[S].style.width=D.rows[Q].cells[S].offsetWidth;T.cells[S].style.height=D.rows[Q].cells[S].offsetHeight}}});var z=H.querySelector(".mc-fixed-column");w.style.width=null;y.style.width=null;E.style.width=null;F.fixedBody.style.width=O.offsetWidth;E.style.height=O.clientHeight;z.appendChild(A);z.appendChild(E)}c(H,L,C,F)};var c=function(B,y,C,w){y.onscroll=function(H){C.scrollLeft=this.scrollLeft;if(j.fixColumnNum>0){var G=w.fixedColumn.querySelector(".mc-tbody table");G.style.marginTop=-this.scrollTop}};var D=B.getElementsByTagName("tr");function z(G,H){D.forEach(function(J){var I=J.getAttribute("ri");if(I===G){if(H){J.addClass("hover")}else{J.removeClass("hover")}}})}u.forEach(D,function(G){G.onmouseover=function(){var H=G.getAttribute("ri");z(H,true)};G.onmouseout=function(){var H=G.getAttribute("ri");z(H,false)}});if(j.checkable===true){var F=B.getElementsByTagName("td").filter(function(G){return G.getAttribute("ci")==="-1"&&G.getAttribute("ri")!=="-1"});var E=B.getElementsByTagName("th").filter(function(G){return G.getAttribute("ci")==="-1"&&G.getAttribute("ri")==="-1"});F.forEach(function(H){var G=H.querySelector("input[type=checkbox]");G.onchange=function(){var J=this.checked;var L=this.parentTag("tr");var M=L.getAttribute("ri");var I=B.querySelectorAll('tr[ri="'+M+'"]');I.forEach(function(N){var O=N.querySelector("input[type=checkbox]");O.checked=J;if(J){N.addClass("checked")}else{N.removeClass("checked")}});var K=u.first(d,{$$index:M});K.$$checked=J;o.fire("row_select")}});function A(G){E.forEach(function(I){var H=I.querySelector("input[type=checkbox]");H.checked=G;j.$$allChecked=G;F.forEach(function(L){var K=L.querySelector("input[type=checkbox]");K.checked=G});d.forEach(function(K){K.$$checked=G});var J=B.getElementsByTagName("tr").filter(function(K){return K.getAttribute("ri")!=="-1"});J.forEach(function(K){if(G){K.addClass("checked")}else{K.removeClass("checked")}});o.fire("row_select")})}E.forEach(function(H){var G=H.querySelector("input[type=checkbox]");G.onchange=function(){A(this.checked)}})}};var f=function(w){u.extend(j,w);var A=0;for(var y=0;y<s.length;y++){s[y]=u.extend({"min-width":"50px",width:"50px",visible:true},s[y]);var z=parseFloat(s[y].width);A+=z}if(j.checkable){A+=30}s[s.length-1].width=null;j.tableWidth=A+"px"};var l=function(w){u.forEach(w,function(z,y){z.$$index=y;z.$$checked=false});d=w};var b=function(B,A){var z=t(B);var y=i(B,A);var w=n("table",z+y,r.table);return w};var k=function(w,y){var z=document.createElement(w);z.className=y;return z};var t=function(B){var A=[];u.forEach(s,function(D,C){if(D.visible){A.push(n("th",D.text,null,D,-1,C))}});if(j.checkable){var w=n("th","<input type='checkbox'/>","check-all check-btn",null,-1,-1);A.unshift(w)}var z=n("tr",A.join(""),null,null,-1);var y=n("thead",z);return y};var e=function(y){var z=[];var w=["width","text-align"];u.forEach(w,function(A){if(y[A]!=null){z.push(A+":"+y[A])}});return z.join(";")};var n=function(B,D,y,z,w,A){var y=y!=null?' class = "'+y+'"':"";var C="";if(z!=null){C=e(z);C=C!=null?' style = "'+C+'"':""}(A!==undefined&&(A=' ci="'+A+'" '))||(A===undefined&&(A=""));(w!==undefined&&(w=' ri="'+w+'" '))||(w===undefined&&(w=""));var E="<"+B+y+w+A+C+">"+D+"</"+B+">";return E};var i=function(z,y){var A=[];var w=[];u.forEach(y,function(E,D){A=[];u.forEach(s,function(G,F){if(G.visible){A.push(n("td",E[G.name],null,G,E.$$index,F))}});if(j.checkable){var C=n("td","<input type='checkbox'/>","check-btn",null,E.$$index,-1);A.unshift(C)}w.push(n("tr",A.join(""),null,null,E.$$index))});var B=n("tbody",w.join(""));return B};u.forEach=function(w,z){var y=0;for(y=0;y<w.length;y++){z(w[y],y)}};u.filter=function(w,A){var y=[];var z=0;for(z=0;z<w.length;z++){if(A(w[z])){y.push(w[z])}}return y};u.first=function(w,A){for(var z=0;z<w.length;z++){if(typeof(A)=="object"){var y=true;for(name in A){if(A[name]!=w[z][name]){y=false;break}}if(y){return w[z]}}else{if(typeof(A)=="function"){if(A(w[z])){return w[z]}}}}};u.extend=function(){var y,A;y=function(C){return Object.prototype.toString.call(C)==="[object Object]"};A=function z(E,D){var C;for(C in D){if(y(E[C])&&y(D[C])){z(E[C],D[C])}E[C]=D[C]}};var w=arguments;if(w.length<=1){return}else{var B;for(B=1;B<w.length;B++){A(w[0],w[B])}}if(w.length>0){return w[0]}};u.getDefaultClass=function(w){var y=document.querySelectorAll(w);if(y!=null&&y.length>0){return y[0].className}};u.all=function(y,A){var w=true;for(var z=0;z<y.length;z++){if(!A(y[z])){w=false;break}}return w};u.clone=function(A){if(null==A||"object"!=typeof A){return A}if(A instanceof Date){var B=new Date();B.setTime(A.getTime());return B}if(A instanceof Array){var B=[];for(var z=0,y=A.length;z<y;++z){B[z]=clone(A[z])}return B}if(A instanceof Object){var B={};for(var w in A){if(A.hasOwnProperty(w)){B[w]=clone(A[w])}}return B}throw new Error("Unable to copy obj! Its type isn't supported.")};NodeList.prototype.forEach=HTMLCollection.prototype.forEach=Array.prototype.forEach=function(w){u.forEach(this,function(y,z){w(y,z)})};NodeList.prototype.filter=HTMLCollection.prototype.filter=Array.prototype.filter=function(w){return u.filter(this,w)};Element.prototype.addClass=function(w){var A=this;var y=A.className;if(y!=null){y.replace(/(\s+)/gi," ");var z=y.split(" ");if(z.indexOf(w)>-1){return}}blank=(y!="")?" ":"";added=y+blank+w;A.className=added};Element.prototype.removeClass=function(w){var z=this;var y=" "+z.className+" ";y=y.replace(/(\s+)/gi," "),removed=y.replace(" "+w+" "," ");removed=removed.replace(/(^\s+)|(\s+$)/g,"");z.className=removed};Element.prototype.hasClass=function(w){var A=this;var y=A.className,z=y.split(/\s+/);x=0;for(x in z){if(z[x]==w){return true}}return false};Element.prototype.parentTag=function(y){var w=this.parentNode;do{if(w.tagName.toUpperCase()===y.toUpperCase()||w.tagName.toUpperCase()=="BODY"){break}var w=w.parentNode}while(true);if(w.tagName.toUpperCase()==="BODY"){return null}else{return w}};function p(w){return(w|0)===w}var m=function(w){if(j.mergeColumnMainIndex!=null&&j.mergeColumns!=null&&j.mergeColumns.length>0&&p(j.mergeColumnMainIndex)){var y=a();h(w,y)}};function a(){var w=j.mergeColumnMainIndex;var F=d;var y=null;var A="";for(var z=0;z<s.length;z++){if(s[z].visible===true){y==null?y=0:y+=1}if(y==w){A=s[z].name;break}}var E=[];var D=[];var B=null;for(var z=0;z<F.length;z++){var C=F[z][A];if(B===null){B=C}if(C===B){D.push(z)}else{E.push(D);D=[];D.push(z);B=C}}if(D.length!=0){E.push(D)}return E}function h(B,C){var y=j.mergeColumns;y=y.sort(function(E,D){return E>D});var w=B.querySelectorAll("tr").filter(function(D){return D.getAttribute("ri")!=="-1"});function z(F,E,G){E=parseInt(E);F=parseInt(F);if(y.indexOf(E)>-1){var D=u.first(G,function(H){return H.indexOf(F)>-1});if(D[0]==F&&D.length==1){return 0}else{if(D[0]!=F&&D.length>1){return -1}else{if(D[0]==F&&D.length>1){return D.length}}}}else{return 0}}var A=[];w.forEach(function(D,F){var E=D.children;var F=D.getAttribute("ri");E.forEach(function(H){var I=H.getAttribute("ci");var G=z(F,I,C);switch(G){case 0:break;case -1:A.push(H);break;case null:break;default:H.setAttribute("rowspan",G);break}})});A.forEach(function(D){D.remove()})}};