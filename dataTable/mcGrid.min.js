function mcGrid(){var o=this;var r={table:"table table-hover table-striped table-condensed table-bordered",tr:null,td:null};var l=o.defaultConfig={$$allChecked:false,checkable:false,sortable:false,tableWidth:"",fixHeaderRow:false,fixColumnNum:0,mergeColumnMainIndex:null,mergeColumns:null};var s=[];var e=[];var u=o._={};var q={RowChecked:[],SortChanged:[],TdInitialize:[]};o.fire=function(w,y){switch(w){case"RowChecked":q.RowChecked.forEach(function(A){var z=e.filter(function(B){return B.$$checked===true});A(z)});break;case"SortChanged":q.SortChanged.forEach(function(A){var B=y;var z=s.first({"$$index":parseInt(B)});A({col:z,orderBy:l.orderBy,ascending:l.ascending})});break;case"TdInitialize":q.TdInitialize.forEach(function(B){var A=y.getAttribute("ci");var C=y.getAttribute("ri");var z=u.first(s,{"$$index":A})||{};var D=u.first(e,{"$$index":C})||{};B({dom:y,col:z,colId:A,row:D})});break}};o.on=function(w,y){q[w]!==null&&(q[w].push(y))};o.InitGrid=function(B,z,A,D){s=A;m(D);h(z);var C=document.getElementById(B);C.removeClass("mc-table");C.addClass("mc-table");var y={wraperContainer:g("div","mc-table-wrapper mc-default"),headDivDom:g("div","mc-thead"),bodyDivDom:g("div","mc-tbody"),fixedColumn:g("div","mc-fixed-column"),fixedBody:g("div","mc-fixed-body")};var w=y.wraperContainer;var E=t(s);var G=k(s,D);var H="";if(l.sortable==true){H=" sortable"}var F=a("table",E+G,r.table+H,{width:l.width});y.bodyDivDom.innerHTML=F;i(y);C.innerHTML="";w.style.visibility="hidden";C.appendChild(w);setTimeout(function(){v(C,y);w.style.visibility="visible"},0)};var h=function(w){u.extend(l,w);l.fixColumnNum=l.fixColumnNum|0;l.isCheckedByRow=!!l.isCheckedByRow;l.isSingleRowSelected=!!l.isSingleRowSelected;for(var y=0;y<s.length;y++){s[y]=u.extend({"min-width":"100px",visible:true},s[y]);var z=parseFloat(s[y].width);s[y].$$index=y}};var m=function(w){u.forEach(w,function(z,y){z.$$index=y;z.$$checked=false});e=w||[]};var f=function(y){var z=[];var w=["min-width","width","text-align"];u.forEach(w,function(A){if(y[A]!=null){z.push(A+":"+y[A])}});return z.join(";")};var i=function(w){if(l.fixHeaderRow&&l.fixColumnNum>0){w.fixedBody.appendChild(w.headDivDom);w.fixedBody.appendChild(w.bodyDivDom);w.wraperContainer.appendChild(w.fixedColumn);w.wraperContainer.appendChild(w.fixedBody)}else{if(l.fixHeaderRow&&l.fixColumnNum==0){w.wraperContainer.appendChild(w.headDivDom);w.wraperContainer.appendChild(w.bodyDivDom)}else{if(!l.fixHeaderRow){w.wraperContainer.appendChild(w.bodyDivDom)}}}};var v=function(I,F){var C=F.headDivDom;var L=F.bodyDivDom;var O=L.querySelectorAll("table");O.forEach(function(S){S.style.width=S.offsetWidth+"px"});var A=L.querySelectorAll("table td");var y=L.querySelectorAll("table th");A.forEach(function(S){S.style.width=S.offsetWidth+"px";o.fire("TdInitialize",S)});y.forEach(function(S){S.style.width=S.offsetWidth+"px"});n(L);if(l.fixHeaderRow&&e.length>0){var N=L.children[0];var Q=N.querySelector("table thead").offsetHeight;var M=N.children[0].offsetHeight;var K=I.offsetHeight-M;var J=N.cloneNode(true);J.removeChild(J.children[1]);C.appendChild(J);L.style.height=K+"px"}if(l.fixHeaderRow&&l.fixColumnNum>0&&e.length>0){var R=I.querySelector(".mc-fixed-body .mc-thead");var w=I.querySelector(".mc-fixed-body .mc-tbody");var H=R.querySelector("table");var B=w.querySelector("table");var E=R.cloneNode(true);var G=w.cloneNode(true);var D=E.querySelector("table");var P=G.querySelector("table");var z=I.querySelector(".mc-fixed-column");setTimeout(function(){var S=D.rows;u.forEach(S,function(W,T){for(var V=0;V<W.cells.length;V++){var U=W.cells[V].getAttribute("ci");if(U>=l.fixColumnNum){W.cells[V].style.display="none"}else{W.cells[V].style.width=B.rows[T].cells[V].offsetWidth+"px";W.cells[V].style.height=B.rows[T].cells[V].offsetHeight+"px"}}});var S=P.rows;u.forEach(S,function(W,T){for(var V=0;V<W.cells.length;V++){var U=W.cells[V].getAttribute("ci");if(U>=l.fixColumnNum){W.cells[V].style.display="none"}else{W.cells[V].style.width=B.rows[T].cells[V].offsetWidth+"px";W.cells[V].style.height=B.rows[T].cells[V].offsetHeight+"px"}}});D.style.width=null;P.style.width=null;G.style.width=null;G.style.height=w.clientHeight+"px"},0);z.appendChild(E);z.appendChild(G)}d(I,L,C,F)};var d=function(C,z,H,y){z.onscroll=function(N){if(l.fixHeaderRow){H.querySelector("table").style.left="-"+this.scrollLeft+"px";if(l.fixColumnNum>0){var M=y.fixedColumn.querySelector(".mc-tbody table");M.style.marginTop="-"+this.scrollTop+"px"}}};var J=C.getElementsByTagName("tr");function A(M,N){J.forEach(function(P){var O=P.getAttribute("ri");if(O===M){if(N){P.addClass("hover")}else{P.removeClass("hover")}}})}u.forEach(J,function(M){M.onmouseover=function(){var N=M.getAttribute("ri");A(N,true)};M.onmouseout=function(){var N=M.getAttribute("ri");A(N,false)}});var B=C.getElementsByTagName("td").filter(function(M){return M.getAttribute("ci")==="-1"&&M.getAttribute("ri")!=="-1"});var K=C.getElementsByTagName("th").filter(function(M){return M.getAttribute("ci")==="-1"&&M.getAttribute("ri")==="-1"});function F(M){K.forEach(function(P){var O=P.querySelector("input[type=checkbox]");O.checked=M;l.$$allChecked=M;B.forEach(function(R){var Q=R.querySelector("input[type=checkbox]");Q.checked=M})});var N=C.getElementsByTagName("tr").filter(function(O){return O.getAttribute("ri")!=="-1"});N.forEach(function(O){if(M){O.addClass("checked")}else{O.removeClass("checked")}});e.forEach(function(O){O.$$checked=M})}function L(R,M){var Q=R;var S=Q.getAttribute("ri");var P=u.first(e,{$$index:S});var O=false;(M!=null)?(O=M.checked):(O=!P.$$checked);if(l.isSingleRowSelected){F(false)}var N=C.querySelectorAll('tr[ri="'+S+'"]');N.forEach(function(T){if(l.checkable){var U=T.querySelector("input[type=checkbox]");U.checked=O}if(O){T.addClass("checked")}else{T.removeClass("checked")}});P.$$checked=O;o.fire("RowChecked")}if(l.checkable===true){B.forEach(function(N){var M=N.querySelector("input[type=checkbox]");var O=N.parentTag("tr");M.onchange=function(){L(O,M)}});K.forEach(function(N){var M=N.querySelector("input[type=checkbox]");M.onchange=function(){F(this.checked);o.fire("RowChecked")}})}if(l.isSingleRowSelected==true&&l.isCheckedByRow===true){var G=C.getElementsByTagName("tr").filter(function(M){return M.getAttribute("ri")!=="-1"});G.forEach(function(M){M.onclick=function(){L(M)}})}if(l.sortable===true){var E=C.getElementsByTagName("th").filter(function(M){return M.getAttribute("ci")!=="-1"});function D(N,M,O){E.forEach(function(P){var Q=P.getAttribute("ci");P.removeClass("sort-up");P.removeClass("sort-down");if(Q==N){M==true?P.addClass("sort-up"):P.addClass("sort-down");l.$$orderByCol=u.first(s,{$$index:N});l.orderBy=l.$$orderByCol.name;l.ascending=M}})}var w=0;if(l.orderBy!=null){var I=u.first(s,{name:l.orderBy});if(I!=null){w=I.$$index}else{w=0;l.orderBy=s[0].name}}else{w=0;l.orderBy=s[0].name}l.ascending=!!l.ascending;s.orderBy!=null||u.first(s,{name:l.orderBy});D(w,l.ascending);E.forEach(function(M){M.onclick=function(){var N=this.getAttribute("ci");var O=true;if(N==l.$$orderByCol.$$index){O=!l.ascending}D(N,O);o.fire("SortChanged",N)}})}};var c=function(B,A){var z=t(B);var y=k(B,A);var w=a("table",z+y,r.table);return w};var g=function(w,y){var z=document.createElement(w);z.className=y;return z};var a=function(B,D,y,z,w,A){var y=y!=null?' class = "'+y+'"':"";var C="";if(z!=null){C=f(z);C=C!=null?' style = "'+C+'"':""}(A!==undefined&&(A=' ci="'+A+'" '))||(A===undefined&&(A=""));(w!==undefined&&(w=' ri="'+w+'" '))||(w===undefined&&(w=""));D=D==null?"":D;var E="<"+B+y+w+A+C+">"+D+"</"+B+">";return E};var t=function(B){var A=[];u.forEach(s,function(D,C){if(D.visible){A.push(a("th",D.text,null,D,-1,D.$$index))}});if(l.checkable){var w=a("th","<input type='checkbox'/>","check-all check-btn",null,-1,-1);A.unshift(w)}var z=a("tr",A.join(""),null,null,-1);var y=a("thead",z);return y};var k=function(z,y){var A=[];var w=[];u.forEach(y,function(E,D){A=[];u.forEach(s,function(G,F){if(G.visible){A.push(a("td",E[G.name],null,G,E.$$index,G.$$index))}});if(l.checkable){var C=a("td","<input type='checkbox'/>","check-btn",null,E.$$index,-1);A.unshift(C)}w.push(a("tr",A.join(""),null,null,E.$$index))});var B=a("tbody",w.join(""));return B};var n=function(w){if(l.mergeColumnMainIndex!=null&&l.mergeColumns!=null&&l.mergeColumns.length>0&&p(l.mergeColumnMainIndex)){var y=b();j(w,y)}};function b(){var w=l.mergeColumnMainIndex;var F=e;var y=null;var A="";for(var z=0;z<s.length;z++){if(s[z].visible===true){y==null?y=0:y+=1}if(y==w){A=s[z].name;break}}var E=[];var D=[];var B=null;for(var z=0;z<F.length;z++){var C=F[z][A];if(B===null){B=C}if(C===B){D.push(z)}else{E.push(D);D=[];D.push(z);B=C}}if(D.length!=0){E.push(D)}return E}function j(B,C){var y=[];l.mergeColumns.forEach(function(D){y.push((D|0))});y=y.sort(function(E,D){return E>D});var w=B.querySelectorAll("tr").filter(function(D){return D.getAttribute("ri")!=="-1"});function z(F,E,G){E=parseInt(E);F=parseInt(F);if(y.indexOf(E)>-1){var D=u.first(G,function(H){return H.indexOf(F)>-1});if(D[0]==F&&D.length==1){return 0}else{if(D[0]!=F&&D.length>1){return -1}else{if(D[0]==F&&D.length>1){return D.length}}}}else{return 0}}var A=[];w.forEach(function(D,F){var E=D.children;var F=D.getAttribute("ri");E.forEach(function(H){var I=H.getAttribute("ci");var G=z(F,I,C);switch(G){case 0:break;case -1:A.push(H);break;case null:break;default:H.setAttribute("rowspan",G);H.style.verticalAlign="middle";break}})});A.forEach(function(D){D.remove()})}u.forEach=function(w,z){if(w==null){return}var y=0;for(y=0;y<w.length;y++){z(w[y],y)}};u.filter=function(w,B){var y=[];var A=0;for(A=0;A<w.length;A++){if(typeof(B)=="object"){var z=true;for(name in B){if(B[name]!=w[A][name]){z=false;break}}if(z){y.push(w[A])}}else{if(typeof(B)=="function"){if(B(w[A])){y.push(w[A])}}}}return y};u.first=function(w,A){for(var z=0;z<w.length;z++){if(typeof(A)=="object"){var y=true;for(name in A){if(A[name]!=w[z][name]){y=false;break}}if(y){return w[z]}}else{if(typeof(A)=="function"){if(A(w[z])){return w[z]}}}}};u.extend=function(){var y,A;y=function(C){return Object.prototype.toString.call(C)==="[object Object]"};A=function z(E,D){var C;for(C in D){if(y(E[C])&&y(D[C])){z(E[C],D[C])}E[C]=D[C]}};var w=arguments;if(w.length<=1){return}else{var B;for(B=1;B<w.length;B++){A(w[0],w[B])}}if(w.length>0){return w[0]}};u.all=function(y,A){var w=true;for(var z=0;z<y.length;z++){if(!A(y[z])){w=false;break}}return w};u.clone=function(A){if(null==A||"object"!=typeof A){return A}if(A instanceof Date){var B=new Date();B.setTime(A.getTime());return B}if(A instanceof Array){var B=[];for(var z=0,y=A.length;z<y;++z){B[z]=clone(A[z])}return B}if(A instanceof Object){var B={};for(var w in A){if(A.hasOwnProperty(w)){B[w]=clone(A[w])}}return B}throw new Error("Unable to copy obj! Its type isn't supported.")};NodeList.prototype.forEach=HTMLCollection.prototype.forEach=Array.prototype.forEach=function(w){u.forEach(this,function(y,z){w(y,z)})};NodeList.prototype.filter=HTMLCollection.prototype.filter=Array.prototype.filter=function(w){return u.filter(this,w)};NodeList.prototype.first=HTMLCollection.prototype.first=Array.prototype.first=function(w){return u.first(this,w)};Element.prototype.addClass=function(w){var A=this;var y=A.className;if(y!=null){y.replace(/(\s+)/gi," ");var z=y.split(" ");if(z.indexOf(w)>-1){return}}blank=(y!="")?" ":"";added=y+blank+w;A.className=added};Element.prototype.removeClass=function(w){var z=this;var y=" "+z.className+" ";y=y.replace(/(\s+)/gi," "),removed=y.replace(" "+w+" "," ");removed=removed.replace(/(^\s+)|(\s+$)/g,"");z.className=removed};Element.prototype.remove=function(){this.parentNode.removeChild(this)};Element.prototype.hasClass=function(w){var A=this;var y=A.className,z=y.split(/\s+/);x=0;for(x in z){if(z[x]==w){return true}}return false};Element.prototype.parentTag=function(y){var w=this.parentNode;do{if(w.tagName.toUpperCase()===y.toUpperCase()||w.tagName.toUpperCase()=="BODY"){break}var w=w.parentNode}while(true);if(w.tagName.toUpperCase()==="BODY"){return null}else{return w}};function p(w){return(w|0)===w}};